<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pop the Balloon ‚Äî Word Guess</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- ‚úÖ Memberstack Loader -->
  <script data-memberstack-app="app_cmgnwpg8y00x10suih4pua785"
          src="https://static.memberstack.com/scripts/v2/memberstack.js"
          type="text/javascript"></script>

  <!-- ‚úÖ Protect this page -->
  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      try {
        const member = await window.$memberstackDom.getCurrentMember();
        if (!member.data) {
          window.location.href = "/subscribe.html";
        }
      } catch {
        window.location.href = "/subscribe.html";
      }
    });
  </script>
</head>

<body class="bg-white text-gray-900 min-h-screen">

  <div class="max-w-6xl mx-auto p-6 text-center">
    <!-- Title -->
    <h1 class="text-6xl font-extrabold mb-4 text-blue-900">Pokeno Caller</h1>
    <!-- Back to Apps -->
    <div class="flex justify-center mb-8">
      <a href="apps.html"
         class="inline-flex items-center gap-2 px-8 py-4 bg-blue-900 text-white rounded-2xl font-extrabold text-2xl shadow hover:bg-blue-800 focus:outline-none focus:ring-4 focus:ring-blue-300">
        ‚Üê Back to Apps
      </a>
    </div>

    <!-- Current Card -->
    <div id="cardDisplay" class="flex justify-center my-12">
      <div class="w-80 h-[28rem] flex items-center justify-center text-[12rem] font-black text-gray-400 border-[12px] border-gray-300 rounded-3xl bg-white shadow-2xl">
        üÇ†
      </div>
    </div>

    <!-- Controls -->
    <div class="flex justify-center gap-6 mb-10">
      <button id="nextBtn"
              class="bg-blue-600 hover:bg-blue-800 text-white text-3xl py-4 px-8 rounded-2xl shadow-lg focus:outline-none focus:ring-4 focus:ring-blue-300">
        Next Card
      </button>
      <button id="resetBtn"
              class="bg-white border-4 border-blue-900 text-blue-900 text-3xl py-4 px-8 rounded-2xl shadow-lg hover:bg-gray-50 focus:outline-none focus:ring-4 focus:ring-blue-300">
        Reset Game
      </button>
    </div>

    <!-- History -->
    <div id="history"
         class="mt-8 text-3xl text-gray-700 flex flex-wrap justify-center gap-4 max-w-5xl mx-auto">
    </div>
  </div>

  <script>
    const suits = ["‚ô†","‚ô•","‚ô¶","‚ô£"];
    const ranks = ["A","2","3","4","5","6","7","8","9","10","J","Q","K"];
    let deck = [];
    let history = [];

    function buildDeck() {
      deck = [];
      for (const s of suits) {
        for (const r of ranks) {
          deck.push({ rank: r, suit: s });
        }
      }
      shuffle(deck);
      history = [];
      updateHistory();
      document.getElementById("cardDisplay").innerHTML =
        `<div class="w-80 h-[28rem] flex items-center justify-center text-[12rem] font-black text-gray-400 border-[12px] border-gray-300 rounded-3xl bg-white shadow-2xl">üÇ†</div>`;
    }

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    function nextCard() {
      if (deck.length === 0) {
        document.getElementById("cardDisplay").innerHTML =
          `<div class="w-80 h-[28rem] flex items-center justify-center text-8xl font-black border-[12px] border-yellow-500 rounded-3xl bg-yellow-100 shadow-2xl">üèÜ</div>`;
        return;
      }
      const card = deck.pop();
      history.push(card);

      const isRed = card.suit === "‚ô•" || card.suit === "‚ô¶";
      const colorClass = isRed ? "text-red-600" : "text-blue-900";

      document.getElementById("cardDisplay").innerHTML =
        `<div class="w-80 h-[28rem] flex flex-col items-center justify-center border-[12px] rounded-3xl bg-white shadow-2xl">
          <div class="text-[12rem] font-black ${colorClass} leading-none">${card.rank}</div>
          <div class="text-[10rem] ${colorClass} leading-none">${card.suit}</div>
        </div>`;

      updateHistory();
    }

    function updateHistory() {
      const histEl = document.getElementById("history");
      histEl.innerHTML = "";
      history.forEach(c => {
        const isRed = c.suit === "‚ô•" || c.suit === "‚ô¶";
        const colorClass = isRed ? "text-red-600" : "text-blue-900";
        const span = document.createElement("span");
        span.innerHTML =
          `<span class="${colorClass} font-bold">${c.rank}${c.suit}</span>`;
        span.className = "px-4 py-2 border border-blue-300 rounded-lg bg-white";
        histEl.appendChild(span);
      });
    }

    document.getElementById("nextBtn").addEventListener("click", nextCard);
    document.getElementById("resetBtn").addEventListener("click", buildDeck);

    buildDeck();
  </script>
</body>
</html>
