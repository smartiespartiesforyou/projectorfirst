<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Bingo Caller | ProjectorFirst</title>
  <meta name="description" content="Large-font, projector-ready Bingo caller."/>
  <link rel="icon" href="/logo.svg" type="image/svg+xml"/>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white font-sans">

  <!-- Shared header -->
  <div data-include="/header.html"></div>
  <script src="/include.js" defer></script>

  <main class="max-w-6xl mx-auto px-4 py-8">
    <div class="flex flex-col lg:flex-row gap-8">
      <!-- Left: Big current call + controls -->
      <section class="flex-1 bg-gray-800 border border-gray-700 rounded-2xl p-6">
        <h1 class="text-3xl font-extrabold mb-4">Bingo Caller</h1>

        <!-- Current call -->
        <div id="currentCall"
             class="text-[14vw] leading-none lg:text-[9rem] font-black text-green-400 text-center select-none">
          —
        </div>

        <!-- Controls -->
        <div class="mt-6 flex flex-wrap items-center gap-3 justify-center">
          <button id="nextBtn"
                  class="px-6 py-3 rounded-2xl bg-green-500 text-gray-900 font-black hover:bg-green-400 transition">
            Call Next
          </button>
          <button id="undoBtn"
                  class="px-6 py-3 rounded-2xl bg-gray-700 text-white font-bold hover:bg-gray-600 transition">
            Undo
          </button>
          <button id="resetBtn"
                  class="px-6 py-3 rounded-2xl bg-red-500 text-white font-bold hover:bg-red-400 transition">
            Reset
          </button>

          <label class="ml-4 inline-flex items-center gap-2">
            <input id="autoToggle" type="checkbox" class="w-5 h-5">
            <span class="text-sm text-gray-300">Auto-call</span>
          </label>
          <select id="speedSel" class="bg-gray-900 border border-gray-700 rounded px-3 py-2 text-sm">
            <option value="6">Every 6s</option>
            <option value="8">Every 8s</option>
            <option value="10" selected>Every 10s</option>
            <option value="12">Every 12s</option>
            <option value="15">Every 15s</option>
          </select>
          <span class="text-xs text-gray-400">Tip: press Space for Next</span>
        </div>
      </section>

      <!-- Right: Board + history -->
      <aside class="w-full lg:w-[44%] flex flex-col gap-6">
        <!-- Board -->
        <section class="bg-gray-800 border border-gray-700 rounded-2xl p-6">
          <div class="grid grid-cols-5 gap-2 text-center">
            <div class="font-black text-lg text-green-400">B</div>
            <div class="font-black text-lg text-green-400">I</div>
            <div class="font-black text-lg text-green-400">N</div>
            <div class="font-black text-lg text-green-400">G</div>
            <div class="font-black text-lg text-green-400">O</div>
          </div>
          <div id="board" class="mt-3 grid grid-cols-5 gap-2"></div>
        </section>

        <!-- History -->
        <section class="bg-gray-800 border border-gray-700 rounded-2xl p-6">
          <div class="flex items-center justify-between mb-2">
            <h2 class="text-xl font-bold">History</h2>
            <div class="text-sm text-gray-400"><span id="count">0</span>/75 called</div>
          </div>
          <div id="history"
               class="min-h-[96px] text-gray-300 text-lg leading-8 break-words">
          </div>
        </section>
      </aside>
    </div>
  </main>

  <script>
    // ----- Data -----
    const columns = {
      B: Array.from({length:15}, (_,i)=>i+1),
      I: Array.from({length:15}, (_,i)=>i+16),
      N: Array.from({length:15}, (_,i)=>i+31),
      G: Array.from({length:15}, (_,i)=>i+46),
      O: Array.from({length:15}, (_,i)=>i+61),
    };
    const all = [...columns.B, ...columns.I, ...columns.N, ...columns.G, ...columns.O];
    let remaining = all.slice();
    let stack = []; // history of called numbers

    // ----- Elements -----
    const currentEl = document.getElementById('currentCall');
    const boardEl   = document.getElementById('board');
    const historyEl = document.getElementById('history');
    const countEl   = document.getElementById('count');
    const nextBtn   = document.getElementById('nextBtn');
    const undoBtn   = document.getElementById('undoBtn');
    const resetBtn  = document.getElementById('resetBtn');
    const autoToggle= document.getElementById('autoToggle');
    const speedSel  = document.getElementById('speedSel');

    // ----- Build Board -----
    const letterOf = (n) => n<=15?'B':n<=30?'I':n<=45?'N':n<=60?'G':'O';

    function renderBoard() {
      boardEl.innerHTML = '';
      // 5 columns of 15 each
      const cols = [columns.B, columns.I, columns.N, columns.G, columns.O];
      for (let row = 0; row < 15; row++) {
        for (let c = 0; c < 5; c++) {
          const num = cols[c][row];
          const cell = document.createElement('div');
          cell.id = 'cell-' + num;
          cell.className = 'select-none rounded-md border border-gray-700 p-2 text-center text-lg';
          cell.textContent = num;
          boardEl.appendChild(cell);
        }
      }
      updateHighlights();
    }

    function updateHighlights() {
      // clear all
      all.forEach(n => {
        const el = document.getElementById('cell-' + n);
        if (!el) return;
        el.classList.remove('bg-green-500','text-gray-900','font-black');
      });
      // mark called
      stack.forEach(n => {
        const el = document.getElementById('cell-' + n);
        if (!el) return;
        el.classList.add('bg-green-500','text-gray-900','font-black');
      });
    }

    function renderHistory() {
      const labels = stack.map(n => letterOf(n) + n);
      historyEl.textContent = labels.join('  ');
      countEl.textContent = stack.length;
    }

    function renderCurrent() {
      if (stack.length === 0) {
        currentEl.textContent = '—';
        return;
      }
      const n = stack[stack.length - 1];
      currentEl.textContent = lette
