<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Classic Bingo Caller â€” ProjectorFirst</title>
  <meta name="description" content="Classic Bingo Caller â€” simple, big-screen friendly bingo caller."/>
  <meta name="theme-color" content="#1e3a8a"/>
  <link rel="icon" href="/logo.svg" type="image/svg+xml"/>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background: #ffffff; color: #000000; }

    .layout-area {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 2rem;
      margin-bottom: 2rem;
      flex-wrap: wrap;
    }

    .caller-box {
      position: relative;
      width: min(90vw, 70vh, 640px);
      height: min(90vw, 70vh, 640px);
      border: 6px solid #1e3a8a;
      border-radius: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: clamp(8rem, 28vmin, 20rem);
      line-height: 1;
      white-space: nowrap;
      font-weight: bold;
      background: #000;
      color: #fff;
      overflow: hidden;
    }

    /* Left column (recent calls) */
    .recent-calls {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      max-height: 80vh;
      overflow-y: auto;
    }

    .recent-calls span {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 90px;
      height: 90px;
      margin: 0.25rem 0;
      border-radius: 50%;
      color: #fff;
      font-size: 2rem;
      font-weight: bold;
    }

    /* Right column (controls) */
    .controls-area {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      gap: 1rem;
    }

    .btn {
      font-size: 1.75rem;
      font-weight: bold;
      padding: 1.25rem 2.5rem;
      border-radius: 1rem;
      transition: background 0.2s;
      width: 100%;
      max-width: 280px;
    }

    .btn-next { background: #1e3a8a; color: white; }
    .btn-next:hover { background: #1d4ed8; }
    .btn-undo { background: #facc15; color: black; }
    .btn-reset { background: #dc2626; color: white; }
    .btn-fullscreen { background: #6d28d9; color: white; }
    .btn-sound { border: 2px solid #1e3a8a; color: #1e3a8a; background: white; }
    .btn-sound:hover { background: #e0e7ff; }
  </style>
</head>
<body class="flex flex-col items-center justify-start min-h-screen py-10">
  <main class="w-full max-w-6xl text-center">
    <h1 class="text-5xl font-extrabold text-blue-900 mb-6">ðŸŽ‰ Classic Bingo Caller</h1>

    <!-- Back to Apps -->
    <div class="mb-6">
      <a href="apps.html" class="btn btn-next">â¬… Back to Apps</a>
    </div>

    <!-- ONE DROPDOWN -->
    <div class="mb-6 text-left">
      <label for="theme" class="block text-lg font-semibold text-blue-900 mb-2">Theme</label>
      <select id="theme"
              class="w-full text-xl p-3 border-2 border-blue-900 rounded-2xl focus:outline-none focus:ring-2 focus:ring-blue-400">
      </select>
    </div>

    <!-- Main Layout: Left balls / Center caller / Right buttons -->
    <div class="layout-area">
      <!-- Left: called balls -->
      <div id="recentCalls" class="recent-calls"></div>

      <!-- Center: caller -->
      <div id="callerBox" class="caller-box">
        <span id="callerText">â€”</span>
        <span id="themeSymbol" style="position:absolute; bottom:10px; right:10px; font-size:2.5rem;"></span>
      </div>

      <!-- Right: buttons -->
      <div class="controls-area">
        <button onclick="callNext()" class="btn btn-next">Call Next (Space)</button>
        <button onclick="undoCall()" class="btn btn-undo">Undo (Backspace)</button>
        <button onclick="resetCaller()" class="btn btn-reset">Reset (R)</button>
        <button onclick="toggleFullscreen()" class="btn btn-fullscreen">Fullscreen (F)</button>
        <button onclick="toggleSound()" id="soundBtn" class="btn btn-sound">ðŸ”Š Sound</button>
      </div>
    </div>
  </main>

  <script>
    function makeTheme(label, ranges = [[1,15],[16,30],[31,45],[46,60],[61,75]], rate = 1.0, symbol = "") {
      return {
        label,
        letters: ["B","I","N","G","O"],
        ranges,
        speakPrefix: (L, n) => `${L} ${n}`,
        speakRate: rate,
        ballClassFromLetter: L => `ball-${L}`,
        symbol
      };
    }

    const THEMES = {
      classic75: makeTheme("Classic 1â€“75 (B I N G O)"),
      uk90:      makeTheme("UK 1â€“90", [[1,18],[19,36],[37,54],[55,72],[73,90]]),
      kids50:    makeTheme("Kids 1â€“50", [[1,10],[11,20],[21,30],[31,40],[41,50]]),
      mini30:    makeTheme("Mini 1â€“30", [[1,6],[7,12],[13,18],[19,24],[25,30]]),
      rapid75:   makeTheme("Rapid 1â€“75 (faster speech)", [[1,15],[16,30],[31,45],[46,60],[61,75]], 1.4),

      halloween75:    makeTheme("Halloween 1â€“75", undefined, 1.0, "ðŸŽƒ"),
      thanksgiving75: makeTheme("Thanksgiving 1â€“75", undefined, 1.0, "ðŸ¦ƒ"),
      christmas75:    makeTheme("Christmas 1â€“75", undefined, 1.0, "ðŸŽ„"),
      easter75:       makeTheme("Easter 1â€“75", undefined, 1.0, "ðŸ£"),
      memorial75:     makeTheme("Memorial Day 1â€“75", undefined, 1.0, "â­"),
      flagday75:      makeTheme("Flag Day 1â€“75", undefined, 1.0, "ðŸ‡ºðŸ‡¸"),
      independence75: makeTheme("Independence Day 1â€“75", undefined, 1.0, "ðŸŽ†"),
      laborday75:     makeTheme("Labor Day 1â€“75", undefined, 1.0, "ðŸ› ï¸"),
      newyear75:      makeTheme("New Yearâ€™s 1â€“75", undefined, 1.0, "ðŸŽ‰"),
      valentines75:   makeTheme("Valentineâ€™s 1â€“75", undefined, 1.0, "ðŸ’˜"),
      stpatricks75:   makeTheme("St. Patrickâ€™s 1â€“75", undefined, 1.0, "â˜˜ï¸")
    };

    let currentThemeKey = "classic75";
    let letters = [];
    let ranges = [];
    let allNumbers = [];
    let history = [];
    let soundOn = true;

    function initThemePicker() {
      const sel = document.getElementById("theme");
      sel.innerHTML = "";
      Object.entries(THEMES).forEach(([key, cfg]) => {
        const opt = document.createElement("option");
        opt.value = key;
        opt.textContent = cfg.label;
        if (key === currentThemeKey) opt.selected = true;
        sel.appendChild(opt);
      });
      sel.addEventListener("change", (e) => {
        currentThemeKey = e.target.value;
        applyTheme();
      });
    }

    function applyTheme() {
      const cfg = THEMES[currentThemeKey];
      letters = cfg.letters;
      ranges = cfg.ranges;
      initGame();
      document.getElementById("themeSymbol").textContent = cfg.symbol || "";
    }

    function initGame() {
      allNumbers = [];
      history = [];
      for (let i = 0; i < letters.length; i++) {
        const [min, max] = ranges[i];
        for (let n = min; n <= max; n++) {
          allNumbers.push({letter: letters[i], number: n});
        }
      }
      shuffle(allNumbers);
      document.getElementById("callerText").textContent = "â€”";
      document.getElementById("recentCalls").innerHTML = "";
    }

    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
    }

    function callNext() {
      if (allNumbers.length === 0) return;
      const call = allNumbers.pop();
      history.push(call);
      document.getElementById("callerText").textContent = call.letter + " " + call.number;
      updateRecent();
      if (soundOn) {
        const cfg = THEMES[currentThemeKey];
        const phrase = cfg.speakPrefix(call.letter, call.number);
        const utter = new SpeechSynthesisUtterance(phrase);
        utter.rate = cfg.speakRate || 1.0;
        speechSynthesis.speak(utter);
      }
    }

    function undoCall() {
      if (history.length === 0) return;
      const last = history.pop();
      allNumbers.push(last);
      document.getElementById("callerText").textContent = "â€”";
      updateRecent();
    }

    function resetCaller() { initGame(); }

    function updateRecent() {
      const cfg = THEMES[currentThemeKey];
      const recentDiv = document.getElementById("recentCalls");
      recentDiv.innerHTML = history
        .slice(-10)
        .reverse()
        .map(c => `<span class="${cfg.ballClassFromLetter(c.letter)}">${c.letter} ${c.number}</span>`)
        .join("");
    }

    function toggleSound() {
      soundOn = !soundOn;
      document.getElementById("soundBtn").textContent = soundOn ? "ðŸ”Š Sound" : "ðŸ”‡ Muted";
    }

    function toggleFullscreen() {
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen();
      } else {
        if (document.exitFullscreen) document.exitFullscreen();
      }
    }

    document.addEventListener("keydown", e => {
      if (e.code === "Space") { e.preventDefault(); callNext(); }
      if (e.code === "Backspace") { e.preventDefault(); undoCall(); }
      if (e.code === "KeyR") { resetCaller(); }
      if (e.code === "KeyF") { toggleFullscreen(); }
    });

    initThemePicker();
    applyTheme();
  </script>
</body>
</html>
