<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>How Much Does It Cost?</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // ------- DATA: add or edit items here -------
    // price in cents (to avoid decimals). e.g., $2.99 = 299
    const items = [
      { name: "Gallon of Milk", price: 399 },
      { name: "Dozen Eggs", price: 299 },
      { name: "Loaf of Bread", price: 249 },
      { name: "Stamp", price: 68 },
      { name: "Coffee (small)", price: 219 },
      { name: "Bananas (1 lb)", price: 89 },
      { name: "Paper Towels (single roll)", price: 179 },
      { name: "Toothpaste", price: 349 },
    ];

    // ------- STATE -------
    let current = 0;
    let score = 0;

    // ------- HELPERS -------
    const $ = (id) => document.getElementById(id);
    const fmt = (cents) =>
      (cents / 100).toLocaleString(undefined, { style: "currency", currency: "USD" });

    function shuffle(a) {
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    // Generate 3 choices: 1 correct + 2 close-ish distractors
    function makeChoices(priceCents) {
      const deltas = [0, randomDelta(priceCents), -randomDelta(priceCents)];
      const raw = deltas.map(d => Math.max(1, priceCents + d));
      const unique = [...new Set(raw)];
      // Ensure exactly 3 options
      while (unique.length < 3) {
        const extra = Math.max(1, priceCents + randomDelta(priceCents));
        if (!unique.includes(extra)) unique.push(extra);
      }
      return shuffle(unique.slice(0, 3));
    }

    // Delta scales with price, rounded to nearest 10 cents
    function randomDelta(priceCents) {
      const span = Math.max(20, Math.round(priceCents * 0.25)); // up to Â±25%
      const step = 10;
      const raw = (Math.floor(Math.random() * (span * 2 + 1)) - span);
      return Math.round(raw / step) * step;
    }

    function loadItem() {
      const item = items[current];
      $("itemName").textContent = item.name;
      $("feedback").textContent = "";
      $("feedback").className = "text-xl font-bold text-center min-h-[1.5rem]";
      const choices = makeChoices(item.price);
      const buttons = [$("c1"), $("c2"), $("c3")];

      buttons.forEach((btn, i) => {
        btn.disabled = false;
        btn.className =
          "w-full bg-blue-900 hover:bg-blue-800 text-white py-4 px-6 rounded-2xl text-2xl font-bold focus:outline-none focus:ring-4 focus:ring-blue-300";
        btn.textContent = fmt(choices[i]);
        btn.setAttribute("data-value", choices[i]);
      });

      $("nextBtn").disabled = true;
      $("nextBtn").classList.add("opacity-60", "cursor-not-allowed");
    }

    function guess(btn) {
      const chosen = Number(btn.getAttribute("data-value"));
      const correct = items[current].price;

      const buttons = [$("c1"), $("c2"), $("c3")];
      buttons.forEach(b => b.disabled = true);

      if (chosen === correct) {
        score += 1;
        $("feedback").textContent = "Correct!";
        $("feedback").className = "text-2xl font-extrabold text-green-700 text-center";
        // mark the chosen as correct
        btn.className = "w-full bg-green-700 text-white py-4 px-6 rounded-2xl text-2xl font-extrabold";
      } else {
        $("feedback").innerHTML = `Not quite. Correct price: <span class="font-extrabold">${fmt(correct)}</span>`;
        $("feedback").className = "text-xl font-bold text-blue-900 text-center";
        // mark chosen as wrong, highlight the correct one
        btn.className = "w-full bg-red-700 text-white py-4 px-6 rounded-2xl text-2xl font-extrabold";
        buttons.forEach(b => {
          if (Number(b.getAttribute("data-value")) === correct) {
            b.className = "w-full bg-green-700 text-white py-4 px-6 rounded-2xl text-2xl font-extrabold";
          }
        });
      }

      $("score").textContent = score;
      $("nextBtn").disabled = false;
      $("nextBtn").classList.remove("opacity-60", "cursor-not-allowed");
    }

    function nextItem() {
      current = (current + 1) % items.length;
      loadItem();
    }

    function resetGame() {
      score = 0;
      current = 0;
      $("score").textContent = score;
      loadItem();
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    window.onload = () => {
      $("score").textContent = score;
      loadItem();
    };
  </script>
</head>

<body class="bg-white text-slate-900 min-h-screen flex flex-col items-center p-6"><script src="lock-check.js"></script>

  <h1 class="text-5xl font-extrabold text-blue-900 mb-4 text-center">How Much Does It Cost?</h1>

  <!-- Score + Controls -->
  <div class="w-full max-w-2xl mb-4">
    <div class="flex items-center justify-between gap-3">
      <div class="border-4 border-blue-900 rounded-2xl px-5 py-3 bg-white">
        <div class="text-xl font-bold text-blue-900">Score</div>
        <div id="score" class="text-4xl font-black text-blue-900">0</div>
      </div>
      <div class="flex gap-3">
        <button id="nextBtn" onclick="nextItem()"
          class="bg-blue-900 text-white px-6 py-3 rounded-2xl text-xl font-extrabold focus:outline-none focus:ring-4 focus:ring-blue-300 opacity-60 cursor-not-allowed"
          disabled>
          Next Item
        </button>
        <button onclick="resetGame()"
          class="bg-white border-4 border-blue-900 text-blue-900 px-6 py-3 rounded-2xl text-xl font-extrabold hover:bg-blue-50 focus:outline-none focus:ring-4 focus:ring-blue-300">
          Reset
        </button>
      </div>
    </div>
  </div>

  <!-- Item -->
  <div class="w-full max-w-2xl space-y-5">
    <div class="rounded-2xl p-6 text-2xl font-bold text-center border-4 border-blue-900 text-blue-900 bg-white">
      <span id="itemName">Loading...</span>
    </div>

    <div id="feedback" class="text-xl font-bold text-center min-h-[1.5rem]"></div>

    <!-- Choices -->
    <div class="grid gap-4">
      <button id="c1" onclick="guess(this)"
        class="w-full bg-blue-900 hover:bg-blue-800 text-white py-4 px-6 rounded-2xl text-2xl font-bold focus:outline-none focus:ring-4 focus:ring-blue-300">
        $0.00
      </button>
      <button id="c2" onclick="guess(this)"
        class="w-full bg-blue-900 hover:bg-blue-800 text-white py-4 px-6 rounded-2xl text-2xl font-bold focus:outline-none focus:ring-4 focus:ring-blue-300">
        $0.00
      </button>
      <button id="c3" onclick="guess(this)"
        class="w-full bg-blue-900 hover:bg-blue-800 text-white py-4 px-6 rounded-2xl text-2xl font-bold focus:outline-none focus:ring-4 focus:ring-blue-300">
        $0.00
      </button>
    </div>
  </div>
</body>
</html>
