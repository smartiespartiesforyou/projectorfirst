<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trivia ‚Äî ProjectorFirst</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body {
      background: #fff;
      color: #111;
      font-family: Arial, sans-serif;
    }
    .modal-bg {
      background: rgba(0,0,0,0.55);
      position: fixed;
      inset: 0;
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 50;
    }
    .modal {
      background: white;
      color: black;
      border-radius: 20px;
      padding: 30px;
      width: 90%;
      max-width: 700px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.3);
    }
    .big-btn {
      font-size: 40px;
      padding: 25px 60px;
      border-radius: 1rem;
      font-weight: 800;
      color: white;
      transition: background-color .1s ease;
    }
    .pf-blue { background: #1e3a8a; }
    .pf-blue:hover { background: #1d4ed8; }
  </style>
</head>

<body class="min-h-screen">
  <!-- HEADER -->
  <div class="max-w-6xl mx-auto flex justify-between items-center p-6 border-b border-gray-200">
    <a href="apps.html" class="pf-blue text-white text-xl font-bold px-5 py-3 rounded-xl">‚Üê Back to Apps</a>
    <button id="openEditor" class="bg-purple-700 text-white text-xl font-bold px-6 py-3 rounded-xl hover:bg-purple-600">
      Question Editor üìù
    </button>
  </div>

  <!-- CATEGORY SCREEN -->
  <div id="categoryScreen" class="text-center mt-10 px-6 max-w-6xl mx-auto">
    <h1 class="text-4xl md:text-6xl font-extrabold text-blue-800 mb-10">Choose a Category</h1>
    <div id="categoryButtons" class="grid grid-cols-1 sm:grid-cols-2 gap-6 max-w-4xl mx-auto"></div>
  </div>

  <!-- GAME SCREEN -->
  <div id="gameScreen" class="text-center mt-16 px-4 hidden max-w-6xl mx-auto">
    <h1 class="text-4xl md:text-6xl font-extrabold text-blue-800 mb-10" id="categoryTitle">Category</h1>

    <h2 id="questionDisplay" class="text-3xl md:text-5xl font-bold mb-16">
      Press ‚ÄúNext Question‚Äù
    </h2>

    <div class="flex justify-center gap-6 md:gap-10 mb-16">
      <button
        id="trueBtn"
        class="big-btn bg-green-600 hover:bg-green-500 hidden">
        TRUE
      </button>

      <button
        id="falseBtn"
        class="big-btn bg-red-600 hover:bg-red-500 hidden">
        FALSE
      </button>
    </div>

    <h2
      id="answerDisplay"
      class="text-7xl md:text-8xl font-extrabold mt-16 mb-6 hidden">
    </h2>

    <!-- NEW: Why button + explanation -->
    <button
      id="whyBtn"
      class="mt-2 px-6 py-3 bg-yellow-400 text-black font-bold rounded-xl text-2xl hidden">
      Why is this TRUE/FALSE?
    </button>

    <p
      id="explanationDisplay"
      class="mt-4 text-2xl md:text-3xl max-w-4xl mx-auto hidden">
    </p>

    <button id="nextBtn" class="big-btn pf-blue mt-12">Next Question</button>

    <div class="mt-8">
      <button id="backToCategories"
              class="px-6 py-3 bg-gray-300 text-gray-800 font-bold rounded-xl hover:bg-gray-200 text-xl">
        ‚¨Ö Back to Categories
      </button>
    </div>
  </div>

  <!-- EDITOR MODAL -->
  <div id="modalBg" class="modal-bg">
    <div class="modal">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-3xl font-bold text-blue-800">Question Editor</h2>
        <button id="closeEditor" class="px-4 py-1 bg-gray-300 rounded-xl font-bold hover:bg-gray-400">Close</button>
      </div>

      <label class="font-bold text-gray-700">Question</label>
      <input id="inputQuestion" class="w-full border p-3 rounded-xl mb-4 text-lg" placeholder="Type your true/false question‚Ä¶">

      <label class="font-bold text-gray-700">Category</label>
      <select id="inputCategory" class="w-full border p-3 rounded-xl mb-4 text-lg"></select>

      <input id="newCategoryInput" class="w-full border p-3 rounded-xl mb-4 text-lg hidden" placeholder="Enter new category‚Ä¶">

      <label class="font-bold text-gray-700">Correct Answer</label>
      <select id="inputAnswer" class="w-full border p-3 rounded-xl mb-4 text-lg">
        <option value="TRUE">TRUE</option>
        <option value="FALSE">FALSE</option>
      </select>

      <!-- OPTIONAL: explanation input for new questions -->
      <label class="font-bold text-gray-700">Explanation (optional)</label>
      <textarea id="inputExplanation" class="w-full border p-3 rounded-xl mb-6 text-lg" placeholder="Why is this TRUE or FALSE? (You can read this aloud to residents)"></textarea>

      <button id="saveBtn" class="bg-green-600 text-white font-bold px-6 py-3 rounded-xl hover:bg-green-500">Save Question</button>

      <h3 class="text-xl font-bold mt-8 mb-2 text-blue-700">Your Saved Questions</h3>
      <ul id="savedList" class="space-y-2 text-lg"></ul>
    </div>
  </div>

<script>
  // üö® DATA VERSION: bump this if you change default questions/categories
  const TF_DATA_VERSION = "2026-01-10-v19";
  const savedVersion = localStorage.getItem("tfDataVersion");
  if (savedVersion !== TF_DATA_VERSION) {
    localStorage.removeItem("tfQuestions");
    localStorage.removeItem("tfCategories");
    localStorage.setItem("tfDataVersion", TF_DATA_VERSION);
  }

  // Default categories
  let categories = JSON.parse(localStorage.getItem("tfCategories") || "[]");
  if (categories.length === 0) {
    categories = [
      "Bible",
      "Animals",
      "History",
      "Food",
      "Fun Facts",
      "Music",
      "Movies",
      "New Orleans",
      "New Years",
      "Old TV Shows",
      "Valentines Day",
      "St Patricks Day",
      "Mardi Gras",
      "Easter",
      "July 4th",
      "Memorial Day",
      "Veterans Day",
      "Halloween",
      "Thanksgiving",
      "Christmas",
    ];
    localStorage.setItem("tfCategories", JSON.stringify(categories));
  }

  // Category button labels (what shows on-screen)
  const CATEGORY_LABELS = {
    Bible: "Bible üìñ",
    Animals: "Animals üêæ",
    History: "History üèõÔ∏è",
    Food: "Food üçé",
    "Fun Facts": "Fun Facts ü§Ø",
    Music: "Music üéµ",
    Movies: "Movies üé¨",
    "New Orleans": "New Orleans ‚öúÔ∏è",
    "New Years": "New Years üéâ",
    "Old TV Shows": "Old TV Shows üì∫",
    "Valentines Day": "Valentine‚Äôs Day ‚ù§Ô∏è",
    "St Patricks Day": "St. Patrick‚Äôs Day ‚òòÔ∏è",
    "Mardi Gras": "Mardi Gras üé≠",
    Easter: "Easter üê£",
    "July 4th": "July 4th üéÜ",
    "Memorial Day": "Memorial Day üïäÔ∏è",
    "Veterans Day": "Veterans Day ‚≠ê",
    Halloween: "Halloween üéÉ",
    Thanksgiving: "Thanksgiving ü¶É",
    Christmas: "Christmas üéÑ",
  };

  // Load questions or create defaults
  let questions = JSON.parse(localStorage.getItem("tfQuestions") || "[]");
  if (questions.length === 0) {
    questions = [
      // Bible Questions (first few shown as example)
 // Bible Questions
{ question: "The Bible has 66 books.", answer: "TRUE", category: "Bible", explanation: "The Protestant Bible contains 66 books in total‚Äî39 Old Testament and 27 New Testament." },
{ question: "Moses built the ark.", answer: "FALSE", category: "Bible", explanation: "Noah built the ark; Moses led Israel out of Egypt and received the Ten Commandments." },
{ question: "David killed Goliath with a stone.", answer: "TRUE", category: "Bible", explanation: "David defeated Goliath using a sling and a single stone." },
{ question: "Jonah was swallowed by a whale.", answer: "TRUE", category: "Bible", explanation: "Jonah was swallowed by a great fish after fleeing from God's command." },
{ question: "Noah‚Äôs Ark rested on Mount Sinai.", answer: "FALSE", category: "Bible", explanation: "The ark landed on Mount Ararat; Mount Sinai is where Moses received the law." },
{ question: "Jesus turned water into wine.", answer: "TRUE", category: "Bible", explanation: "Jesus' first miracle took place at a wedding in Cana." },
{ question: "Adam and Eve lived in the Garden of Eden.", answer: "TRUE", category: "Bible", explanation: "Genesis states Adam and Eve lived in Eden before disobeying God." },
{ question: "The Ten Commandments were given to Abraham.", answer: "FALSE", category: "Bible", explanation: "Moses received the Ten Commandments on Mount Sinai." },
{ question: "Paul‚Äôs name was originally Saul.", answer: "TRUE", category: "Bible", explanation: "Saul became known as Paul after his conversion on the Damascus Road." },
{ question: "Ruth was Naomi‚Äôs daughter.", answer: "FALSE", category: "Bible", explanation: "Ruth was Naomi's daughter-in-law, not her biological daughter." },
{ question: "The serpent tempted Eve to eat the forbidden fruit.", answer: "TRUE", category: "Bible", explanation: "In Genesis, Satan tempts Eve using a serpent." },
{ question: "There were three wise men at Jesus‚Äô birth.", answer: "FALSE", category: "Bible", explanation: "The Bible never states how many wise men visited‚Äîonly that there were three gifts." },
{ question: "Jesus fed 5,000 people with five loaves and two fish.", answer: "TRUE", category: "Bible", explanation: "The miracle of feeding the 5,000 appears in all four Gospels." },
{ question: "The book of Psalms is in the New Testament.", answer: "FALSE", category: "Bible", explanation: "Psalms is part of the Old Testament and contains prayers and songs." },
{ question: "Mary Magdalene was the first to see Jesus after His resurrection.", answer: "TRUE", category: "Bible", explanation: "The Gospels record Mary Magdalene as the first witness of the risen Jesus." },
{ question: "Joseph‚Äôs brothers sold him into slavery.", answer: "TRUE", category: "Bible", explanation: "Joseph's jealous brothers sold him, leading him to Egypt where God used him greatly." },
{ question: "The Red Sea was parted by Elijah.", answer: "FALSE", category: "Bible", explanation: "Moses parted the Red Sea when Israel fled Pharaoh‚Äôs army." },
{ question: "Solomon was known for his great wisdom.", answer: "TRUE", category: "Bible", explanation: "God granted Solomon extraordinary wisdom when he became king." },
{ question: "The Bible begins with the words 'In the beginning God created...'", answer: "TRUE", category: "Bible", explanation: "Genesis 1:1 opens with creation by God." },
{ question: "The Book of Revelation is the first book of the Bible.", answer: "FALSE", category: "Bible", explanation: "Revelation is the final book, not the first‚Äîthe first is Genesis." },
{ question: "Jesus was baptized in the Jordan River.", answer: "TRUE", category: "Bible", explanation: "John the Baptist baptized Jesus in the Jordan River." },
{ question: "Peter denied Jesus three times.", answer: "TRUE", category: "Bible", explanation: "Before the rooster crowed, Peter denied knowing Jesus three times." },
{ question: "The Tower of Babel was built to reach heaven.", answer: "TRUE", category: "Bible", explanation: "People attempted to build a tower in Babel, and God confused their languages." },
{ question: "Daniel was thrown into a den of lions.", answer: "TRUE", category: "Bible", explanation: "Daniel was punished for praying to God but miraculously survived the lions‚Äô den." },
{ question: "Samson lost his strength when his hair was cut.", answer: "TRUE", category: "Bible", explanation: "Samson's strength was tied to his Nazirite vow; Delilah cut his hair." },
{ question: "The Prodigal Son‚Äôs father rejected him when he returned.", answer: "FALSE", category: "Bible", explanation: "The father welcomed him joyfully‚Äîsymbolizing forgiveness and grace." },
{ question: "Jesus rode into Jerusalem on a horse.", answer: "FALSE", category: "Bible", explanation: "Jesus entered Jerusalem riding a donkey, fulfilling prophecy." },
{ question: "Abraham and Sarah had a son named Isaac.", answer: "TRUE", category: "Bible", explanation: "Isaac was the long-awaited son God promised Abraham and Sarah." },
{ question: "The first miracle Jesus performed was healing a blind man.", answer: "FALSE", category: "Bible", explanation: "Jesus‚Äô first recorded miracle was turning water into wine." },
{ question: "Jesus was born in Bethlehem.", answer: "TRUE", category: "Bible", explanation: "Jesus was born in Bethlehem, fulfilling prophecy and announced to shepherds." },

     // Easter Questions
{ question: "Easter celebrates the resurrection of Jesus Christ.", answer: "TRUE", category: "Easter", explanation: "Easter honors the day Christians believe Jesus rose from the dead." },
{ question: "Easter is celebrated on the same date every year.", answer: "FALSE", category: "Easter", explanation: "Easter changes yearly because it follows the lunar calendar, not a fixed date." },
{ question: "Easter Sunday always falls on a Sunday.", answer: "TRUE", category: "Easter", explanation: "By definition Easter is always observed on a Sunday." },
{ question: "Easter is considered the most important Christian holiday.", answer: "TRUE", category: "Easter", explanation: "The resurrection is central to Christian faith, making Easter highly significant." },
{ question: "The word Easter appears many times in the Bible.", answer: "FALSE", category: "Easter", explanation: "Most translations never use the word 'Easter'; only 'Passover' appears." },

{ question: "Easter follows the season of Lent.", answer: "TRUE", category: "Easter", explanation: "Lent is a 40-day season that leads up to Easter Sunday." },
{ question: "Lent lasts for about 40 days.", answer: "TRUE", category: "Easter", explanation: "Lent traditionally lasts 40 days, representing Jesus‚Äô time in the wilderness." },
{ question: "Good Friday comes before Easter Sunday.", answer: "TRUE", category: "Easter", explanation: "Good Friday commemorates Jesus‚Äô crucifixion two days before Easter." },
{ question: "Good Friday celebrates the birth of Jesus.", answer: "FALSE", category: "Easter", explanation: "Good Friday marks Jesus‚Äô crucifixion, not His birth." },
{ question: "Easter celebrates new life and hope.", answer: "TRUE", category: "Easter", explanation: "Easter symbolizes renewal and new beginnings through the resurrection." },

{ question: "Easter eggs are a symbol of new life.", answer: "TRUE", category: "Easter", explanation: "Eggs represent rebirth, tying into the resurrection theme." },
{ question: "Egg decorating is an Easter tradition.", answer: "TRUE", category: "Easter", explanation: "People have decorated eggs for Easter for centuries in many cultures." },
{ question: "Chocolate eggs are commonly associated with Easter.", answer: "TRUE", category: "Easter", explanation: "Candy companies popularized chocolate eggs in the 19th century." },
{ question: "The Easter Bunny is a religious figure.", answer: "FALSE", category: "Easter", explanation: "The rabbit is a folk tradition and not part of the Bible story." },
{ question: "Children often participate in Easter egg hunts.", answer: "TRUE", category: "Easter", explanation: "Egg hunts are a common American and European Easter tradition." },

{ question: "Easter baskets are commonly given to children.", answer: "TRUE", category: "Easter", explanation: "Families often give baskets filled with candy and treats on Easter morning." },
{ question: "The Easter Bunny traditionally delivers eggs and candy.", answer: "TRUE", category: "Easter", explanation: "Folklore says the bunny hides eggs for children to find." },
{ question: "Easter is only celebrated in the United States.", answer: "FALSE", category: "Easter", explanation: "Easter is observed worldwide by Christians and many cultures." },
{ question: "Many cultures celebrate Easter in different ways.", answer: "TRUE", category: "Easter", explanation: "Traditions vary from egg rolling to bonfires to special meals." },
{ question: "Easter has both religious and cultural traditions.", answer: "TRUE", category: "Easter", explanation: "Some practices are about faith, while others are seasonal or symbolic." },

{ question: "Sunrise services are sometimes held on Easter morning.", answer: "TRUE", category: "Easter", explanation: "Churches gather at sunrise to honor the empty tomb story." },
{ question: "Easter marks the end of the church calendar year.", answer: "FALSE", category: "Easter", explanation: "Easter is central, but the church year continues afterward." },
{ question: "The Easter season lasts only one day.", answer: "FALSE", category: "Easter", explanation: "In many churches Easter lasts several weeks, known as the Easter season." },
{ question: "White lilies are often associated with Easter.", answer: "TRUE", category: "Easter", explanation: "Easter lilies symbolize purity, resurrection, and new life." },
{ question: "Easter always occurs in the winter.", answer: "FALSE", category: "Easter", explanation: "Easter occurs in spring in the Northern Hemisphere." },

{ question: "The date of Easter is based on the lunar calendar.", answer: "TRUE", category: "Easter", explanation: "Easter falls on the first Sunday after the first full moon of spring." },
{ question: "Easter can fall in March or April.", answer: "TRUE", category: "Easter", explanation: "Because it follows the moon, Easter dates move between March and April." },
{ question: "Palm Sunday occurs before Easter.", answer: "TRUE", category: "Easter", explanation: "Palm Sunday marks Jesus entering Jerusalem one week before Easter." },
{ question: "Palm Sunday celebrates Jesus entering Jerusalem.", answer: "TRUE", category: "Easter", explanation: "People waved palms as Jesus rode into the city." },
{ question: "Easter traditions often focus on family gatherings.", answer: "TRUE", category: "Easter", explanation: "Families commonly enjoy meals, worship, and events together." },

{ question: "Easter eggs were originally made of plastic.", answer: "FALSE", category: "Easter", explanation: "Eggs were originally real eggs before plastic ones became popular." },
{ question: "Easter encourages messages of forgiveness and renewal.", answer: "TRUE", category: "Easter", explanation: "The resurrection story emphasizes forgiveness, grace, and rebirth." },
{ question: "All Easter traditions are religious.", answer: "FALSE", category: "Easter", explanation: "Many are cultural or seasonal, not part of the Bible story." },
{ question: "Easter is a time of celebration and joy.", answer: "TRUE", category: "Easter", explanation: "Christians celebrate Jesus‚Äô victory over death on Easter." },
{ question: "Easter has been celebrated for many centuries.", answer: "TRUE", category: "Easter", explanation: "Christians have observed Easter since the earliest church times." },

    // Mardi Gras Questions
{ question: "Mardi Gras means 'Fat Tuesday' in French.", answer: "TRUE", category: "Mardi Gras", explanation: "Mardi = Tuesday, Gras = Fat in French." },
{ question: "Mardi Gras is always celebrated on the same date each year.", answer: "FALSE", category: "Mardi Gras", explanation: "It changes yearly because it depends on the Easter calendar." },
{ question: "Mardi Gras takes place before the season of Lent.", answer: "TRUE", category: "Mardi Gras", explanation: "Lent begins the day after Mardi Gras, on Ash Wednesday." },
{ question: "Mardi Gras is most closely associated with New Orleans in the U.S.", answer: "TRUE", category: "Mardi Gras", explanation: "New Orleans is famous for its parades and celebrations." },
{ question: "Purple, green, and gold are Mardi Gras colors.", answer: "TRUE", category: "Mardi Gras", explanation: "Purple stands for justice, green for faith, gold for power." },

{ question: "Purple represents justice in Mardi Gras traditions.", answer: "TRUE", category: "Mardi Gras", explanation: "Each Mardi Gras color has a symbolic meaning." },
{ question: "Green represents wealth in Mardi Gras traditions.", answer: "FALSE", category: "Mardi Gras", explanation: "Green represents faith." },
{ question: "Gold represents power in Mardi Gras traditions.", answer: "TRUE", category: "Mardi Gras", explanation: "Gold symbolizes power or authority." },

{ question: "Mardi Gras parades feature decorated floats.", answer: "TRUE", category: "Mardi Gras", explanation: "Krewes build floats for the parades each year." },
{ question: "Beads are commonly thrown during Mardi Gras parades.", answer: "TRUE", category: "Mardi Gras", explanation: "Krewes toss beads, cups, and trinkets to people watching." },

{ question: "Mardi Gras is only celebrated in New Orleans.", answer: "FALSE", category: "Mardi Gras", explanation: "Cities like Mobile and Rio de Janeiro have celebrations too." },
{ question: "Mobile, Alabama claims the first American Mardi Gras.", answer: "TRUE", category: "Mardi Gras", explanation: "Mobile held Mardi Gras years before New Orleans." },
{ question: "King Cake is a dessert eaten during Mardi Gras season.", answer: "TRUE", category: "Mardi Gras", explanation: "King Cake is a traditional sweet bread with icing and colored sugar." },
{ question: "King Cake always has a tiny plastic baby inside.", answer: "FALSE", category: "Mardi Gras", explanation: "Most do, but some bakeries skip it or put it on the side." },
{ question: "Finding the baby in a King Cake means you have to host the next party.", answer: "TRUE", category: "Mardi Gras", explanation: "Tradition says the finder supplies the next cake or party." },

{ question: "The group that organizes a Mardi Gras parade is called a 'crew'.", answer: "FALSE", category: "Mardi Gras", explanation: "It‚Äôs spelled 'krewe'." },
{ question: "Rex is a famous Mardi Gras parade king.", answer: "TRUE", category: "Mardi Gras", explanation: "Rex is a historic krewe known for its royal court." },
{ question: "Throws are items that parade riders toss to the crowd.", answer: "TRUE", category: "Mardi Gras", explanation: "Beads, doubloons, and cups are popular throws." },
{ question: "Mardi Gras Day is the final day of Carnival season.", answer: "TRUE", category: "Mardi Gras", explanation: "Carnival starts on Twelfth Night and ends on Fat Tuesday." },
{ question: "Ash Wednesday is the day after Mardi Gras.", answer: "TRUE", category: "Mardi Gras", explanation: "Ash Wednesday marks the beginning of Lent." },

{ question: "Mardi Gras celebrations always fall in February.", answer: "FALSE", category: "Mardi Gras", explanation: "Depending on Easter, it can fall in March too." },
{ question: "Carnival season begins on January 6th, also known as Twelfth Night.", answer: "TRUE", category: "Mardi Gras", explanation: "January 6 begins the Mardi Gras season." },
{ question: "Flambeaux are flaming torches historically carried in night parades.", answer: "TRUE", category: "Mardi Gras", explanation: "They originally lit the streets before electric lights." },
{ question: "Masks are not allowed during Mardi Gras.", answer: "FALSE", category: "Mardi Gras", explanation: "Mask wearing is a big Mardi Gras tradition!" },
{ question: "Some Mardi Gras parade floats are kept secret until the parade begins.", answer: "TRUE", category: "Mardi Gras", explanation: "Many krewes reveal themes only on parade day." },
                  /* your remaining categories follow here... */
];
localStorage.setItem("tfQuestions", JSON.stringify(questions));
}
  // Grab DOM elements
  const modalBg = document.getElementById("modalBg");
  const categoryButtons = document.getElementById("categoryButtons");
  const inputCategory = document.getElementById("inputCategory");
  const newCategoryInput = document.getElementById("newCategoryInput");
  const savedList = document.getElementById("savedList");

  const questionDisplay = document.getElementById("questionDisplay");
  const answerDisplay = document.getElementById("answerDisplay");
  const trueBtn = document.getElementById("trueBtn");
  const falseBtn = document.getElementById("falseBtn");
  const whyBtn = document.getElementById("whyBtn");
  const explanationDisplay = document.getElementById("explanationDisplay");

  // STATE
  let current = null;
  let filtered = [];

  // RENDER CATEGORY BUTTONS
  function renderCategoryButtons() {
    categoryButtons.innerHTML = "";
    categories.forEach(cat => {
      const btn = document.createElement("button");
      btn.className = "pf-blue text-white text-2xl md:text-3xl font-bold py-6 rounded-2xl transition-all hover:scale-[1.02]";
      btn.textContent = CATEGORY_LABELS[cat] || cat;
      btn.onclick = () => startCategory(cat);
      categoryButtons.appendChild(btn);
    });
  }
  renderCategoryButtons();

  // CATEGORY DROPDOWN IN EDITOR
  function updateCategoryDropdown() {
    inputCategory.innerHTML = "";
    categories.forEach(cat => {
      const opt = document.createElement("option");
      opt.value = cat;
      opt.textContent = cat;
      inputCategory.appendChild(opt);
    });
    const addNew = document.createElement("option");
    addNew.value = "__NEW__";
    addNew.textContent = "+ Add New Category";
    inputCategory.appendChild(addNew);
  }
  updateCategoryDropdown();

  inputCategory.onchange = () => {
    if (inputCategory.value === "__NEW__") newCategoryInput.classList.remove("hidden");
    else newCategoryInput.classList.add("hidden");
    updateSavedList();
  };

  // OPEN/CLOSE EDITOR
  document.getElementById("openEditor").onclick = () => {
    modalBg.style.display = "flex";
    updateSavedList();
  };
  document.getElementById("closeEditor").onclick = () => {
    modalBg.style.display = "none";
    newCategoryInput.value = "";
    newCategoryInput.classList.add("hidden");
  };

  // SAVE QUESTION
  document.getElementById("saveBtn").onclick = () => {
    const q = document.getElementById("inputQuestion").value.trim();
    let cat = inputCategory.value;
    const a = document.getElementById("inputAnswer").value;
    const expl = document.getElementById("inputExplanation").value.trim();

    if (!q) return alert("Please enter a question.");
    if (cat === "__NEW__") {
      cat = newCategoryInput.value.trim();
      if (!cat) return alert("Enter a category name.");
      categories.push(cat);
      localStorage.setItem("tfCategories", JSON.stringify(categories));
      renderCategoryButtons();
      updateCategoryDropdown();
    }

    const newQ = { question: q, answer: a, category: cat };
    if (expl) newQ.explanation = expl;

    questions.push(newQ);
    localStorage.setItem("tfQuestions", JSON.stringify(questions));

    document.getElementById("inputQuestion").value = "";
    document.getElementById("inputExplanation").value = "";
    newCategoryInput.value = "";
    newCategoryInput.classList.add("hidden");
    inputCategory.value = cat;
    updateSavedList();
  };

  // SAVED LIST IN EDITOR
  function updateSavedList() {
    const cat = inputCategory.value;
    savedList.innerHTML = "";

    if (cat === "__NEW__") {
      savedList.innerHTML = `<p class="text-gray-500 italic">Select a category to view questions.</p>`;
      return;
    }

    const filteredQs = questions
      .map((q, idx) => ({ ...q, _idx: idx }))
      .filter(q => q.category === cat);

    if (filteredQs.length === 0) {
      savedList.innerHTML = `<p class="text-gray-500 italic">No questions yet for this category.</p>`;
      return;
    }

    filteredQs.forEach(q => {
      const li = document.createElement("li");
      li.innerHTML = `
        <div class="flex justify-between bg-gray-100 p-3 rounded-xl items-center">
          <div class="flex-1">
            <strong>${q.question}</strong> ‚Äî
            <span class="text-${q.answer === 'TRUE' ? 'green' : 'red'}-600 font-semibold">${q.answer}</span>
            <em class="text-gray-500">(${q.category})</em>
          </div>
          <button onclick="deleteQuestion(${q._idx})"
            class="bg-red-500 text-white px-3 py-1 rounded-lg hover:bg-red-600 ml-4 whitespace-nowrap">
            Delete
          </button>
        </div>`;
      savedList.appendChild(li);
    });

    savedList.style.maxHeight = "300px";
    savedList.style.overflowY = "auto";
    savedList.style.paddingRight = "10px";
  }

  function deleteQuestion(index) {
    if (index >= 0 && index < questions.length) {
      questions.splice(index, 1);
      localStorage.setItem("tfQuestions", JSON.stringify(questions));
      updateSavedList();
    }
  }
  window.deleteQuestion = deleteQuestion;

  // START CATEGORY
  function startCategory(cat) {
    filtered = questions.filter(q => q.category === cat);

    document.getElementById("categoryScreen").classList.add("hidden");
    document.getElementById("gameScreen").classList.remove("hidden");
    document.getElementById("categoryTitle").textContent = CATEGORY_LABELS[cat] || cat;

    questionDisplay.textContent = 'Press ‚ÄúNext Question‚Äù';
    answerDisplay.classList.add("hidden");
    trueBtn.classList.add("hidden");
    falseBtn.classList.add("hidden");
    whyBtn.classList.add("hidden");
    explanationDisplay.classList.add("hidden");
    explanationDisplay.textContent = "";

    current = null;
  }

  // NEXT QUESTION
  document.getElementById("nextBtn").onclick = () => {
    if (filtered.length === 0) {
      alert("No questions in this category yet! Add some using the Question Editor.");
      return;
    }
    current = filtered[Math.floor(Math.random() * filtered.length)];

    questionDisplay.textContent = current.question;
    answerDisplay.classList.add("hidden");
    trueBtn.classList.remove("hidden");
    falseBtn.classList.remove("hidden");
    whyBtn.classList.add("hidden");
    explanationDisplay.classList.add("hidden");
    explanationDisplay.textContent = "";
  };

  // CHECK ANSWER
  function checkAnswer(choice) {
    if (!current) return;

    // Show the correct answer big (TRUE or FALSE)
    answerDisplay.textContent = current.answer;
    answerDisplay.classList.remove("hidden");

    trueBtn.classList.add("hidden");
    falseBtn.classList.add("hidden");

    // Explanation handling
    if (current.explanation) {
      whyBtn.classList.remove("hidden");
      explanationDisplay.textContent = current.explanation;
      explanationDisplay.classList.add("hidden"); // show only after click
    } else {
      whyBtn.classList.add("hidden");
      explanationDisplay.textContent = "";
      explanationDisplay.classList.add("hidden");
    }
  }

  // TRUE/FALSE buttons
  trueBtn.onclick = () => checkAnswer("TRUE");
  falseBtn.onclick = () => checkAnswer("FALSE");

  // WHY button
  whyBtn.onclick = () => {
    explanationDisplay.classList.toggle("hidden");
  };

  // BACK TO CATEGORIES
  document.getElementById("backToCategories").onclick = () => {
    document.getElementById("gameScreen").classList.add("hidden");
    document.getElementById("categoryScreen").classList.remove("hidden");

    questionDisplay.textContent = 'Press ‚ÄúNext Question‚Äù';
    answerDisplay.classList.add("hidden");
    trueBtn.classList.add("hidden");
    falseBtn.classList.add("hidden");
    whyBtn.classList.add("hidden");
    explanationDisplay.classList.add("hidden");
    explanationDisplay.textContent = "";

    current = null;
    filtered = [];
  };
</script>

</body>
</html>
