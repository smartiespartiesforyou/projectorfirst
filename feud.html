<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Family Feud — ProjectorFirst</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- ✅ Sounds -->
  <audio id="dingSound" src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3"></audio>
  <audio id="buzzSound" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-buzz-960.mp3"></audio>

  <style>
    .big-x-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(255, 0, 0, 0.75);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      font-size: 22rem;
      color: white;
      font-weight: 900;
      text-shadow: 0 0 20px black;
      pointer-events: none;
    }
  </style>
</head>

<body class="bg-white text-gray-900">

<div id="bigX" class="big-x-overlay hidden">X</div>

<div class="w-full px-4 py-4 max-w-7xl mx-auto">

  <!-- TOP BAR -->
  <div class="flex items-center justify-center gap-10 mb-4">

    <!-- TEAM 1 -->
    <div class="flex flex-col items-center">
      <button id="team1Turn"
        class="px-6 py-3 rounded-xl text-white font-bold bg-blue-900">
        Table 1 Turn
      </button>
      <div class="text-center mt-2">
        <div class="text-xl font-semibold text-blue-900">Table 1</div>
        <div id="score1" class="text-5xl font-black text-blue-900">0</div>
      </div>
    </div>

    <!-- Divider -->
    <div class="w-px h-20 bg-gray-300"></div>

    <!-- TEAM 2 -->
    <div class="flex flex-col items-center">
      <button id="team2Turn"
        class="px-6 py-3 rounded-xl text-white font-bold bg-blue-400">
        Table 2 Turn
      </button>
      <div class="text-center mt-2">
        <div class="text-xl font-semibold text-blue-900">Table 2</div>
        <div id="score2" class="text-5xl font-black text-blue-900">0</div>
      </div>
    </div>

  </div>


  <!-- CONTROLS -->
  <div class="flex justify-center gap-3 mb-6">
    <a href="apps.html"
       class="px-6 py-3 bg-blue-900 text-white rounded-xl text-xl font-bold">← Apps</a>

    <button id="fullscreenBtn"
            class="px-6 py-3 bg-blue-700 text-white rounded-xl font-bold">⛶ Full Screen</button>

    <button id="openEditor"
            class="px-6 py-3 bg-purple-700 text-white rounded-xl font-bold">Question Editor</button>

    <button id="resetScores"
            class="px-6 py-3 bg-gray-700 text-white rounded-xl font-bold">Reset Scores</button>
  </div>


  <!-- QUESTION -->
  <div id="questionText"
       class="text-5xl font-extrabold text-center text-blue-900 mb-6">
  </div>

  <!-- ANSWERS GRID -->
  <div id="answersContainer"
       class="grid grid-cols-2 gap-6 max-w-5xl mx-auto">
  </div>

  <!-- STRIKES + BUTTONS -->
  <div class="text-center mt-6">
    <div class="mb-3 flex justify-center gap-2">
      <div id="strike1" class="text-6xl text-red-600 font-black opacity-20">X</div>
      <div id="strike2" class="text-6xl text-red-600 font-black opacity-20">X</div>
      <div id="strike3" class="text-6xl text-red-600 font-black opacity-20">X</div>
    </div>

    <button id="wrongBtn"
            class="px-8 py-3 bg-red-600 text-white text-xl rounded-xl font-bold hover:bg-red-700">
      Wrong
    </button>

    <button id="clearStrikes"
            class="px-6 py-3 bg-gray-500 text-white rounded-xl ml-3">
      Clear Strikes
    </button>

    <button id="revealAll"
            class="px-6 py-3 bg-blue-500 text-white rounded-xl ml-3">
      Reveal All
    </button>

    <button id="nextQuestion"
            class="px-6 py-3 bg-yellow-400 text-black rounded-xl ml-3 font-bold">
      Next Question ➜
    </button>
  </div>
</div>
<script>
/* --------------------------------------------------
   ✅ FULL JAVASCRIPT FOR FAMILY FEUD
-------------------------------------------------- */

const dingSound = document.getElementById("dingSound");
const buzzSound = document.getElementById("buzzSound");

const bigX = document.getElementById("bigX");

function showBigX() {
  bigX.classList.remove("hidden");
  void bigX.offsetWidth;
  setTimeout(() => bigX.classList.add("hidden"), 2000); // ✅ 2 seconds
}

/* --------------------------------------------------
   ✅ DATA + SAVE/LOAD
-------------------------------------------------- */

let questions = JSON.parse(localStorage.getItem("feudQuestions") || "[]");

let currentIndex = 0;
let currentStrikes = 0;

let activeTeam = 1; // 1 or 2

let score = {
  1: 0,
  2: 0
};

const score1Display = document.getElementById("score1");
const score2Display = document.getElementById("score2");

function updateScores() {
  score1Display.textContent = score[1];
  score2Display.textContent = score[2];
}

/* --------------------------------------------------
   ✅ RENDER QUESTION + ANSWERS
-------------------------------------------------- */

const questionText = document.getElementById("questionText");
const answersContainer = document.getElementById("answersContainer");

function renderQuestion() {
  const q = questions[currentIndex];
  questionText.textContent = q.question;

  answersContainer.innerHTML = "";

  q.answers.forEach((ans, i) => {
    const tile = document.createElement("div");
    tile.className =
      "bg-green-700 text-white text-4xl font-extrabold p-6 rounded-2xl border-4 border-yellow-300 cursor-pointer";

    tile.innerHTML = `#${i + 1} ${ans.text} <span class="float-right">${ans.points}</span>`;
    tile.style.opacity = "0";

    tile.addEventListener("click", () => {
      if (tile.dataset.revealed) return;

      tile.dataset.revealed = true;
      tile.style.opacity = "1";

      dingSound.currentTime = 0;
      dingSound.play();

      // ✅ Auto-score to active team
      score[activeTeam] += ans.points;
      updateScores();
    });

    answersContainer.appendChild(tile);
  });

  resetStrikes();
}

/* --------------------------------------------------
   ✅ STRIKES
-------------------------------------------------- */

function resetStrikes() {
  currentStrikes = 0;
  ["strike1", "strike2", "strike3"].forEach(id => {
    document.getElementById(id).style.opacity = ".2";
  });
}

function addStrike() {
  if (currentStrikes >= 3) return;

  buzzSound.currentTime = 0;
  buzzSound.play();
  showBigX();

  currentStrikes++;
  document.getElementById("strike" + currentStrikes).style.opacity = "1";
}

/* --------------------------------------------------
   ✅ QUESTION NAVIGATION
-------------------------------------------------- */

function nextQuestion() {
  currentIndex++;
  if (currentIndex >= questions.length) currentIndex = 0;
  renderQuestion();
}

/* --------------------------------------------------
   ✅ EDITOR PANEL
-------------------------------------------------- */

const editorPanel = document.createElement("div");
editorPanel.className =
  "fixed top-0 left-0 w-full h-full bg-black bg-opacity-50 hidden z-50 flex items-start justify-center p-10";

editorPanel.innerHTML = `
  <div class="bg-white rounded-2xl p-8 w-full max-w-3xl shadow-2xl">
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-3xl font-bold text-blue-900">Question Editor</h2>
      <button id="closeEditor"
        class="px-4 py-2 bg-gray-800 text-white rounded-xl">Close</button>
    </div>

    <label class="font-bold text-lg">Question</label>
    <input id="editQuestion" class="w-full border-2 border-blue-800 rounded-xl p-3 text-lg mb-4">

    <div id="answerList"></div>

    <button id="addAnswer"
      class="mt-4 px-4 py-2 bg-blue-700 text-white rounded-xl">+ Add Answer</button>

    <div class="mt-6 text-right">
      <button id="saveQuestion"
        class="px-6 py-3 bg-green-700 text-white rounded-xl font-bold">Save to Library</button>
    </div>

    <h3 class="text-xl font-bold mt-8">Your Saved Questions</h3>
    <ul id="savedList" class="mt-3 text-lg"></ul>
  </div>
`;

document.body.appendChild(editorPanel);

function openEditor() {
  editorPanel.classList.remove("hidden");
  loadEditor();
}

function closeEditor() {
  editorPanel.classList.add("hidden");
}

function loadEditor() {
  const q = questions[currentIndex];
  document.getElementById("editQuestion").value = q.question;

  const ansList = document.getElementById("answerList");
  ansList.innerHTML = "";

  q.answers.forEach((ans, i) => addAnswerRow(ans.text, ans.points));

  loadSavedList();
}

function addAnswerRow(text = "", points = "") {
  const row = document.createElement("div");
  row.className = "flex gap-3 mb-2";

  row.innerHTML = `
    <input class="flex-1 border-2 border-blue-800 rounded-xl p-2" placeholder="Answer" value="${text}">
    <input class="w-20 border-2 border-blue-800 rounded-xl p-2" placeholder="Pt" value="${points}">
    <button class="px-3 bg-red-500 text-white rounded-xl removeAns">X</button>
  `;

  row.querySelector(".removeAns").onclick = () => row.remove();

  document.getElementById("answerList").appendChild(row);
}

function loadSavedList() {
  const list = document.getElementById("savedList");
  list.innerHTML = "";

  questions.forEach((q, i) => {
    const item = document.createElement("li");
    item.className = "mb-1 cursor-pointer text-blue-800";
    item.textContent = q.question;

    item.onclick = () => {
      currentIndex = i;
      renderQuestion();
      closeEditor();
    };

    list.appendChild(item);
  });
}

function saveQuestion() {
  const newQuestion = document.getElementById("editQuestion").value.trim();

  if (!newQuestion) return;

  const answerRows = [...document.querySelectorAll("#answerList > div")];

  let newAnswers = [];

  answerRows.forEach(r => {
    const text = r.children[0].value.trim();
    const pts = parseInt(r.children[1].value.trim());
    if (text && pts >= 0) {
      newAnswers.push({ text, points: pts });
    }
  });

  questions[currentIndex] = {
    question: newQuestion,
    answers: newAnswers
  };

  localStorage.setItem("feudQuestions", JSON.stringify(questions));

  renderQuestion();
  loadSavedList();
  closeEditor();
}

/* --------------------------------------------------
   ✅ BUTTON HOOKS
-------------------------------------------------- */

document.getElementById("wrongBtn").onclick = addStrike;
document.getElementById("clearStrikes").onclick = resetStrikes;
document.getElementById("nextQuestion").onclick = nextQuestion;
document.getElementById("revealAll").onclick = () => {
  [...answersContainer.children].forEach(t => {
    if (!t.dataset.revealed) {
      t.dataset.revealed = true;
      t.style.opacity = "1";
      dingSound.currentTime = 0;
      dingSound.play();

      const pts = parseInt(t.querySelector("span").textContent);
      score[activeTeam] += pts;
      updateScores();
    }
  });
};

document.getElementById("team1Turn").onclick = () => { activeTeam = 1; };
document.getElementById("team2Turn").onclick = () => { activeTeam = 2; };

document.getElementById("resetScores").onclick = () => {
  score = {1: 0, 2: 0};
  updateScores();
};

document.getElementById("openEditor").onclick = openEditor;
document.getElementById("closeEditor").onclick = closeEditor;

document.getElementById("addAnswer").onclick = () => addAnswerRow();

/* --------------------------------------------------
   ✅ FULLSCREEN
-------------------------------------------------- */

document.getElementById("fullscreenBtn").onclick = () => {
  if (!document.fullscreenElement) {
    document.documentElement.requestFullscreen();
  } else {
    document.exitFullscreen();
  }
};

/* --------------------------------------------------
   ✅ AUTO-LOAD FIRST QUESTION
-------------------------------------------------- */

if (questions.length === 0) {
  questions = [
    {
      question: "Name a season of the year.",
      answers: [
        { text: "Summer", points: 35 },
        { text: "Winter", points: 30 },
        { text: "Fall", points: 20 },
        { text: "Spring", points: 15 }
      ]
    }
  ];
  localStorage.setItem("feudQuestions", JSON.stringify(questions));
}

renderQuestion();

</script>

</body>
</html>
